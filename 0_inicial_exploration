# =====================================================================
# üß† PROJECT OVERVIEW

# Title: Financial and Behavioral Analysis in E-Commerce
# Author: Maria Figueiredo
# Dataset: Online Retail (UCI Machine Learning Repository)
# Source: https://archive.ics.uci.edu/ml/datasets/Online+Retail

# =====================================================================
# üéØ OBJECTIVE
# This project aims to explore, clean, and analyze real-world e-commerce
# transaction data to uncover insights about customer behavior, sales
# performance, and purchasing patterns. By understanding the structure
# and dynamics of online shopping data, we establish the foundation for
# subsequent financial and predictive analyses (CLV, churn, and demand).

# The dataset contains over half a million transactions from a UK-based
# online retail store, including invoice details, product descriptions,
# prices, quantities, and customer IDs. This rich dataset enables both
# quantitative and behavioral exploration across time and geography.

# =====================================================================
# üí° WHY THIS ANALYSIS MATTERS
# In the current digital economy, data-driven decision-making defines
# the competitive advantage of companies. E-commerce businesses generate
# massive amounts of transactional data daily, but often fail to extract
# its full potential.

# Through this analysis, we:
# - Identify key financial drivers behind online sales.
# - Understand customer purchasing behavior over time.
# - Detect patterns of loyalty, churn, and seasonal demand.
# - Build a foundation for future forecasting and AI-based insights.

# Beyond its corporate relevance, this type of analytical framework has
# broader **societal and industrial value**:
#   ‚ñ™ Supports sustainable retail planning by reducing waste and overstock.
#   ‚ñ™ Encourages fairer pricing strategies and personalized offers.
#   ‚ñ™ Promotes digital literacy and transparency in commerce.
#   ‚ñ™ Bridges the gap between academic research and real-world application.
#
# Ultimately, this project exemplifies how analytics can translate data
# into knowledge, efficiency, and ethical innovation ‚Äî empowering
# organizations to make smarter and more sustainable decisions.

# =====================================================================
# üß© ANALYTICAL ROADMAP
# 1Ô∏è‚É£ Data Exploration
#     ‚Üí Understand dataset structure, quality, and completeness.

# 2Ô∏è‚É£ Data Cleaning & Feature Engineering
#     ‚Üí Remove invalid transactions and build key analytical variables.

# 3Ô∏è‚É£ Descriptive Financial & Behavioral Analysis
#     ‚Üí Measure sales performance, geographic patterns, and customer metrics.

# 4Ô∏è‚É£ Predictive Modeling (Later Steps)
#     ‚Üí Forecast revenue, churn, and product demand using statistical
#       and machine learning techniques.

# =====================================================================
# üìà VALUE FOR INDUSTRY AND SOCIETY
# ‚ñ´ For businesses:
#     - Enhanced understanding of consumer behavior.
#     - Improved forecasting and resource allocation.
#     - Reduced customer attrition and increased lifetime value.

# ‚ñ´ For society:
#     - More efficient, less wasteful consumption cycles.
#     - Data-informed strategies for economic sustainability.
#     - Empowerment through transparency and analytical innovation.

# =====================================================================
# üß≠ CURRENT STEP
# This first script focuses on the **initial data exploration**:
#   - Loading and examining the dataset.
#   - Understanding structure, variables, and missing values.
#   - Building a data dictionary and identifying the next steps.

# These steps are crucial to ensure data integrity and clarity before
# conducting deeper financial and behavioral analyses.~

# =====================================================================
# ‚ö†Ô∏è Disclaimer
# To run this script:
# 1. Download the dataset "Online Retail.xlsx" (UCI Machine Learning Repository)
# 2. Place it inside the folder: /data/
# 3. Run

################################################################ 0. Initial Setup ################################################################

#IMPORT LIBRARIES
import os
import pandas as pd

# LOAD DATA
file_path = "Online Retail.xlsx"
if not os.path.exists(file_path):
    raise FileNotFoundError(
        f"‚ùå O ficheiro 'Online Retail.xlsx' n√£o foi encontrado em {file_path}.\n"
        f"‚û°Ô∏è Certifica-te que o colocaste na pasta 'data/'."
    )

df = pd.read_excel(file_path)

#INITIAL EXPLORATION
print("üîπ Basic Information:\n")
df.info()

print("\nüîπ First 5 Rows:\n")
print(df.head())

print("\nüîπ Statistical Summary (Numerical Columns):\n")
print(df.describe())

################################################################ 1. Pre-Analysis ################################################################

# ANALYSIS OF THE DATA STRUCTURE
print("\nüîπ Dataset Overview:")
print(f"Number of rows: {df.shape[0]:,}")
print(f"Number of columns: {df.shape[1]}")
print(f"Column names: {list(df.columns)}")

print("\nüîπ Missing Values per Column:\n")
print(df.isnull().sum())

# CREATE A DATA DICTIONARY
data_dictionary = {
    "InvoiceNo": "Unique identifier for each transaction (invoices starting with 'C' indicate cancellations/refunds).",
    "StockCode": "Internal code for the product.",
    "Description": "Text description of the product (some missing values).",
    "Quantity": "Number of product units sold. Negative values indicate returns.",
    "InvoiceDate": "Date and time of the transaction.",
    "UnitPrice": "Price per unit in British Pounds (¬£).",
    "CustomerID": "Unique identifier of the customer (about 25% missing).",
    "Country": "Country of the customer."
}

print("\nüîπ Data Dictionary:\n")
for col, desc in data_dictionary.items():
    print(f"{col}: {desc}")

################################################################ 2. Dataset Interpretation ################################################################

# INTERPRETATION AND KEY FINDINGS
print("\nüîπ Key Findings from Initial Exploration:\n")
print("""
1. The dataset contains 541,909 transactions ‚Äî a large enough sample for robust analysis.
2. The 'InvoiceDate' column allows for time-based analysis (monthly, daily, seasonal trends).
3. Missing data:
   - 'CustomerID': around 25% missing values ‚Äî likely guest or unregistered purchases.
   - 'Description': around 1,500 missing values.
4. Negative quantities in 'Quantity' represent product returns or cancellations.
5. Transactions span multiple countries (‚âà38), enabling geographic comparisons.
6. All monetary values are in British Pounds (¬£).
""")
